<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
  <meta http-equiv="Content-Type" content="text/html" charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />


  <title>Pelican and GitHub Pages workflow</title>


  <meta name="HandheldFriendly" content="True" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta name="referrer" content="origin" />
  <meta name="generator" content="Pelican" />
<link href="https://anotherdatum.com/pelican-and-github-pages-workflow.html" rel="canonical" />
  <!-- Feed -->
        <link href="https://anotherdatum.com/feeds/all.atom.xml" type="application/atom+xml" rel="alternate" title="Another Datum Full Atom Feed" />

  <link href="https://anotherdatum.com/theme/css/style.css" type="text/css" rel="stylesheet" />

  <!-- Code highlight color scheme -->
      <link href="https://anotherdatum.com/theme/css/code_blocks/tomorrow.css" rel="stylesheet">

    <!-- CSS specified by the user -->


    <link href="https://anotherdatum.com/css/overrides.css" type="text/css" rel="stylesheet" />

  <!-- Custom fonts -->
  <link href='https://fonts.googleapis.com/css?family=Montserrat:400,300' rel='stylesheet' type='text/css' />
  <link href="https://fonts.googleapis.com/css?family=Lato" rel="stylesheet" type="text/css" />

  <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.5.0/css/font-awesome.min.css" rel="stylesheet" type="text/css">
  <link href='https://fonts.googleapis.com/css?family=Lora:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800' rel='stylesheet' type='text/css'>

  <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
  <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
  <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
  <![endif]-->



    <meta name="description" content="A simple workflow for writing blog posts using Pelican and GitHub Pages.">

    <meta name="author" content="Yoel Zeldes">

    <meta name="tags" content="pelican">
    <meta name="tags" content="git">




<!-- Open Graph -->
<meta property="og:site_name" content="Another Datum"/>
<meta property="og:title" content="Pelican and GitHub Pages workflow"/>
<meta property="og:description" content="A simple workflow for writing blog posts using Pelican and GitHub Pages."/>
<meta property="og:locale" content="en_US"/>
<meta property="og:url" content="https://anotherdatum.com/pelican-and-github-pages-workflow.html"/>
<meta property="og:type" content="article"/>
<meta property="article:published_time" content="2016-11-08 21:00:00+02:00"/>
<meta property="article:modified_time" content=""/>
<meta property="article:author" content="https://anotherdatum.com/author/yoel-zeldes.html">
  <meta property="article:publisher" content="https://www.facebook.com/yoel.zeldes" />
<meta property="article:section" content="pelican workflow"/>
<meta property="article:tag" content="pelican"/>
<meta property="article:tag" content="git"/>
<meta property="og:image" content="https://anotherdatum.com/images/pelican-and-github-pages-workflow/cover.png">

<!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:site" content="@YZeldes">
    <meta name="twitter:title" content="Pelican and GitHub Pages workflow">
    <meta name="twitter:url" content="https://anotherdatum.com/pelican-and-github-pages-workflow.html">

        <meta name="twitter:image:src" content="https://anotherdatum.com/images/pelican-and-github-pages-workflow/cover.png">

      <meta name="twitter:description" content="A simple workflow for writing blog posts using Pelican and GitHub Pages.">

<script type="application/ld+json">
{
  "@context": "http://schema.org",
  "@type": "Article",
  "name": "Pelican and GitHub Pages workflow",
  "headline": "Pelican and GitHub Pages workflow",
  "datePublished": "2016-11-08 21:00:00+02:00",
  "dateModified": "",
  "author": {
    "@type": "Person",
    "name": "Yoel Zeldes",
    "url": "https://anotherdatum.com/author/yoel-zeldes.html"
  },
  "image": "https://anotherdatum.com/images/pelican-and-github-pages-workflow/cover.png",
  "url": "https://anotherdatum.com/pelican-and-github-pages-workflow.html",
  "description": "A simple workflow for writing blog posts using Pelican and GitHub Pages."
}
</script>
</head>
<!-- TODO : Body class -->
<body class="home-template">

<nav id="menu">
  <a class="close-button">Close</a>
  <div class="nav-wrapper">
    <p class="nav-label">Menu</p>
    <ul>
          <li><a href="https://anotherdatum.com" role="presentation">Posts</a></li>

              <li role="presentation"><a href="https://anotherdatum.com/pages/about.html">about me</a></li>
              <li role="presentation"><a href="https://anotherdatum.com/pages/resources.html">Resources</a></li>

    </ul>
  </div>
</nav>
    <!-- Progressbar -->
    <div class="progress-container">
        <span class="progress-bar"></span>
    </div>

    <!-- Page Header -->
    <!-- Set your background image for this header on the line below. -->
    <header id="post-header" class="has-cover">
      <div class="inner">
        <nav id="navigation">
            <span id="home-button" class="nav-button">
                <a class="home-button" href="https://anotherdatum.com/" title="Home"><i class="ic ic-arrow-left"></i> Home</a>
            </span>
          <span id="menu-button" class="nav-button">
            <a class="menu-button"><i class="ic ic-menu"></i> Menu</a>
          </span>
        </nav>
        <h1 class="post-title">Pelican and GitHub Pages workflow</h1>
        <!-- TODO : Proper class for headline -->
        <span class="post-meta">
            <time datetime="08 November 2016">08 November 2016</time>
        </span>
        <!-- TODO : Modified check -->
            <div class="post-cover cover" style="background-image: url('https://anotherdatum.com/images/pelican-and-github-pages-workflow/cover.png')">
      </div>
    </header>

  <section id="wrapper">
    <a class="hidden-close"></a>

    <!-- Post content -->
    <main class="content" role="main">
        <article class="post">
        <div class="inner">
            <section class="post-content">
                <p>This blog is powered by <a href="http://docs.getpelican.com/en/stable">Pelican</a> and hosted through GitHub using <a href="https://pages.github.com/">GitHub Pages</a>.
In this post I'll describe the workflow I use when deploying new posts.</p>
<p>For those of you not familiar with these technologies, Pelican is a static site generator - meaning you can write your content in a format such
as <a href="http://daringfireball.net/projects/markdown">Markdown</a>, and Pelican will automatically generate the HTML files for you; and GitHub Pages is
a service provided by GitHub for hosting a website under the &lt;your-username>.github.io URL.</p>
<p>Using Pelican and GitHub Pages is quite easy. There's one annoying little thing though... GitHub Pages assumes
the <code>master</code> branch contains the root folder to be served to the world. If you're using Pelican's default settings, the <code>output</code>
folder is the folder you want to serve. <code>output</code> contains the generated website's files.
A natural choice of how to organize the files inside the repository
would be to define pelican's root folder - the parent of <code>output</code> - as the root of the repository. But GitHub Pages needs
<code>output</code> to be the root. Bummer...</p>
<p>There are <a href="http://mavant.com/blog/2014/03/10/pelican-git-hooks-github-dot-io">those</a>
who solve it using two separate repositories: one for the website "source" files, and
one for the output which will be served using GitHub Pages.</p>
<p>I personally don't like breaking my blog into two repositories. I want to keep everything in one place, so I chose to solve the problem
using branches and git hooks.</p>
<p>The first step is to create two branches:</p>
<ul>
<li><code>source</code> will contain the blog's "source" files, namely - all the files such as the <code>content</code> folder which contains the actual posts, and <code>pelicanconf.py</code> file.</li>
<li><code>master</code> will contain only the contents of <code>output</code>.</li>
</ul>
<p>These branches will obviously live in my GitHub Pages repo
(<a href="https://github.com/yoel-zeldes/yoel-zeldes.github.io">https://github.com/yoel-zeldes/yoel-zeldes.github.io</a>),
and since the <code>master</code> branch contains <code>output</code>'s contents, a user navigating to <a href="yoel-zeldes.github.io">yoel-zeldes.github.io</a>
will be presented with the goodness of my blog.</p>
<p>Unfortunately, manually maintaining these two branches is cumbersome. Git hooks to the rescue!</p>
<p>Git has a mechanism to execute custom scripts when certain important actions occur. In my case, whenever I push a commit to the <code>source</code> branch,
I'd like the <code>master</code> branch to get updated with the new contents of <code>output</code>. This can be done using the pre-push hook, which is executed -
you guessed it - just before a push occurs.</p>
<p>All you have to do is create a file named <code>.git/hooks/pre-push</code> with the following content:</p>
<div class="highlight"><pre><span></span><code><span class="ch">#!/bin/sh</span>
<span class="k">while</span> <span class="nb">read</span> local_ref local_sha remote_ref remote_sha
<span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="nv">$remote_ref</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;refs/heads/source&quot;</span> <span class="o">]</span>
        <span class="k">then</span>
                <span class="nb">echo</span> <span class="s1">&#39;pushing output folder (production version) to master...&#39;</span>
                pelican content -o output -s publishconf.py
                <span class="nb">echo</span> anotherdatum.com &gt; output/CNAME
                ghp-import output
                git push --no-verify git@github.com:yoel-zeldes/yoel-zeldes.github.io.git gh-pages:master
                pelican content -o output
        <span class="k">fi</span>
<span class="k">done</span>

<span class="nb">exit</span> <span class="m">0</span>
</code></pre></div>

<ol>
<li>The first thing the script does is iterating over the commits that are about to be pushed. Specifically, only commits that are pushed to the
<code>source</code> branch are of interest to us.</li>
<li>If commits are pushed to <code>source</code>, it executes <code>pelican</code> command using <code>publishconf.py</code>. This will generate the production version of the blog into <code>output</code>.</li>
<li>It then creates a <code>CNAME</code> file, which is needed since I use a custom domain (<a href="http://anotherdatum.com">http://anotherdatum.com</a>).</li>
<li>The <a href="https://github.com/davisp/ghp-import">GitHub Pages Import</a> tool is used for copying the contents of <code>output</code> to a branch named <code>gh-pages</code>.</li>
<li><code>gh-pages</code> is pushed to the remote <code>master</code> branch. <code>--no-verify</code> skips the pre-push hook so this script won't run again.</li>
<li><code>pelican</code> is executed again to generate the development version of my blog, so I'll be able to write the next post.</li>
</ol>
<p>Now, whenever I push to <code>source</code>, and only to <code>source</code>, <code>master</code> gets updated with the new contents. Cool!</p>
<p>One last small detail: I added <code>output</code> to the <code>.gitignore</code> file. This way, the <code>source</code> branch won't include this folder.
We don't really want to put it under version control - it would be like putting other types of generated files such as
<code>.pyc</code> or <code>.o</code> under version control.</p>
            </section>

            <section class="post-info">
                <div class="post-share">
                    <a class="twitter" href="https://twitter.com/share?text=Pelican and GitHub Pages workflow&amp;url=https://anotherdatum.com/pelican-and-github-pages-workflow.html" onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
                    <i class="ic ic-twitter"></i><span class="hidden">Twitter</span>
                    </a>
                    <a class="facebook" href="https://www.facebook.com/sharer/sharer.php?u=https://anotherdatum.com/pelican-and-github-pages-workflow.html" onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
                    <i class="ic ic-facebook"></i><span class="hidden">Facebook</span>
                    </a>
                    <div class="clear"></div>
                </div>

                <aside class="post-tags">
<a href="https://anotherdatum.com/tag/pelican.html">pelican</a><a href="https://anotherdatum.com/tag/git.html">git</a>                </aside>

                <div class="clear"></div>


                </section>

<!-- Begin MailChimp Signup Form -->
<link href="//cdn-images.mailchimp.com/embedcode/classic-10_7.css" rel="stylesheet" type="text/css">
<style type="text/css">
	#mc_embed_signup{background:#fff; clear:left; font:14px Helvetica,Arial,sans-serif;  width:300px;}
	#mc_embed_signup form{padding: 0;}
	/* Add your own MailChimp form style overrides in your site stylesheet or in this style block.
	   We recommend moving this block and the preceding CSS link to the HEAD of your HTML file. */
</style>
<div id="mc_embed_signup">
<form action="https://anotherdatum.us14.list-manage.com/subscribe/post?u=6894d7badcfb253606fa3fb54&amp;id=c6f34ad6b7" method="post" id="mc-embedded-subscribe-form" name="mc-embedded-subscribe-form" class="validate" target="_blank" novalidate>
    <div id="mc_embed_signup_scroll">
	<h2>Get updated of new posts</h2>
<div class="mc-field-group">
	<label for="mce-EMAIL">Email Address </label>
	<input type="email" value="" name="EMAIL" class="required email" id="mce-EMAIL">
</div>
	<div id="mce-responses" class="clear">
		<div class="response" id="mce-error-response" style="display:none"></div>
		<div class="response" id="mce-success-response" style="display:none"></div>
	</div>    <!-- real people should not fill this in and expect good things - do not remove this or risk form bot signups-->
    <div style="position: absolute; left: -5000px;" aria-hidden="true"><input type="text" name="b_6894d7badcfb253606fa3fb54_c6f34ad6b7" tabindex="-1" value=""></div>
    <div class="clear"><input type="submit" value="Subscribe" name="subscribe" id="mc-embedded-subscribe" class="button"></div>
    </div>
</form>
</div>
<script type='text/javascript' src='//s3.amazonaws.com/downloads.mailchimp.com/js/mc-validate.js'></script><script type='text/javascript'>(function($) {window.fnames = new Array(); window.ftypes = new Array();fnames[0]='EMAIL';ftypes[0]='email';fnames[1]='FNAME';ftypes[1]='text';fnames[2]='LNAME';ftypes[2]='text';}(jQuery));var $mcj = jQuery.noConflict(true);</script>
<!--End mc_embed_signup-->
<hr />
                <aside class="post-nav">
                    <a class="post-nav-next" href="https://anotherdatum.com/avoid-committing-junk.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-left"></i>
                                <h2 class="post-nav-title">Avoid committing junk</h2>
                            <p class="post-nav-excerpt">Have you ever accidentaly pushed temporary stuff to the remote git server? Then keep reading.</p>
                        </section>
                    </a>
                    <a class="post-nav-prev" href="https://anotherdatum.com/detecting-anomalies-in-a-SMART-Way-part-three.html">
                        <section class="post-nav-teaser">
                            <i class="ic ic-arrow-right"></i>
                                <h2 class="post-nav-title">Detecting Anomalies in a SMART Way (Part Three)</h2>
                            <p class="post-nav-excerpt">Third part of a posts series about finding anomalous users.</p>
                        </section>
                    </a>
                    <div class="clear"></div>
                </aside>

                <div class="comments">
                    <h2>Comments !</h2>
                    <div id="disqus_thread"></div>
                    <script type="text/javascript">
                        var disqus_shortname = 'anotherdatum';
                        var disqus_identifier = 'pelican-and-github-pages-workflow.html';
                        var disqus_url = 'https://anotherdatum.com/pelican-and-github-pages-workflow.html';
                        (function() {
                            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
                            dsq.src = '//anotherdatum.disqus.com/embed.js';
                            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
                        })();
                    </script>
                    <noscript>Please enable JavaScript to view the comments.</noscript>
                </div>
            </div>
        </article>
    </main>
      <!-- TODO : Body class -->
    <div id="body-class" style="display: none;" class=""></div>

    <footer id="footer">
            <div class="social">
                <a href="https://il.linkedin.com/in/yoelzeldes">
                    <span class="fa-stack fa-lg">
                        <i class="fa fa-circle fa-stack-2x"></i>
                        <i class="fa fa-linkedin fa-stack-1x fa-inverse"></i>
                    </span>
                </a>
                <a href="https://github.com/yoel-zeldes">
                    <span class="fa-stack fa-lg">
                        <i class="fa fa-circle fa-stack-2x"></i>
                        <i class="fa fa-github fa-stack-1x fa-inverse"></i>
                    </span>
                </a>
                <a href="https://www.facebook.com/yoel.zeldes">
                    <span class="fa-stack fa-lg">
                        <i class="fa fa-circle fa-stack-2x"></i>
                        <i class="fa fa-facebook fa-stack-1x fa-inverse"></i>
                    </span>
                </a>
                <a href="https://twitter.com/YZeldes">
                    <span class="fa-stack fa-lg">
                        <i class="fa fa-circle fa-stack-2x"></i>
                        <i class="fa fa-twitter fa-stack-1x fa-inverse"></i>
                    </span>
                </a>
            </div>

      <div class="inner">
        <section class="credits">
          <span class="credits-theme">Have a look at <a href="https://github.com/yoel-zeldes/yoel-zeldes.github.io/tree/source">the source code</a> of this blog.</span>
        </section>
      </div>
    </footer>
  </section>

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://anotherdatum.com/theme/js/script.js"></script>

    <!-- Global Site Tag (gtag.js) - Google Analytics -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-83684090-1"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'UA-83684090-1', { 'anonymize_ip': true });
    </script>
<script type="text/javascript">
    var disqus_shortname = 'anotherdatum';
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
</body>
</html>